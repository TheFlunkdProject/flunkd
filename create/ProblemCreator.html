<!doctype html>
<html>
<head>
<script src="ExpressionEvaluater.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
   tex2jax: {inlineMath: [["$","$"]]},
   displayAlign: "center",
   displayIndent: "0.1em"
  });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML.js"></script>
<script>
</script>
<style>
</style>
</head>
<body>
<p id="p1">$x^2$
	This problem creator can give each user unique numbers to work with. 
	Random numbers will be inserted for var1 and var2 in the question you write.
</p>
<p id="p2">
	Question:
</p>
<textarea id="question"></textarea>
<p id="p2">
	Within what range would you like var1 and var2 to be generated?
</p>
<p>
var1 range: <input type="text" id="var1From"/> to <input type="text" id="var1To"/>
<br>
var2 range: <input type="text" id="var2From"/> to <input type="text" id="var2To"/>
</p>
<p id="p3">
	What form should the answer be in?
	<input type="text" id="answer"/>
</p>
<br>
<input type="button" id="createProblemButton" onclick="createProblem()" value="Create Problem"/>
<p id="generatedQuestion">
</p>
<input type="text" id="userAnswer"  style="visibility:hidden"/>
<input type="button" id="checkAnswer" onclick="answerProblem()" value="Check" style="visibility:hidden"/>
<p id="feedback">
</p>
<script>
var generatedAnswer = {};

function createProblem() {
question = document.getElementById('question').value;

var var1From = parseFloat(document.getElementById('var1From').value);
var var1To = parseFloat(document.getElementById('var1To').value);
var var1FromDecimalPlace = var1From.toString().indexOf(".");
var var1ToDecimalPlace = var1From.toString().indexOf(".");
var var1Precision = 0;
var var1Magnitude = 0;
var var1Number = 0;
var random1 = parseFloat(Math.random());

var1ReplaceString = "var1";
if (var1FromDecimalPlace != -1 || var1ToDecimalPlace != -1)
	{
	var1Precision = Math.max(var1From.toString().length - var1FromDecimalPlace - 1, var1To.toString().length - var1ToDecimalPlace - 1);
	var1Magnitude = Math.pow(10, var1Precision);
	var1Number = Math.floor(var1Magnitude*(random1*(var1To - var1From) + var1From))/var1Magnitude;
	}
else 
	{
	var1Number = Math.round(random1*(var1To - var1From) + var1From);
	}
var1NumberToString = var1Number.toString();


var var2From = parseFloat(document.getElementById('var2From').value);
var var2To = parseFloat(document.getElementById('var2To').value);
var var2FromDecimalPlace = var2From.toString().indexOf(".");
var var2ToDecimalPlace = var2From.toString().indexOf(".");
var var2Precision = 0;
var var2Magnitude = 0;
var random2 = parseFloat(Math.random());

var2ReplaceString = "var2";
if (var2FromDecimalPlace != -1 || var2ToDecimalPlace != -1)
	{
	var2Precision = Math.max(var2From.toString().length - var2FromDecimalPlace - 1, var2To.toString().length - var2ToDecimalPlace - 1);
	var2Magnitude = Math.pow(10, var2Precision);
	var2Number = Math.floor(var2Magnitude*(random2*(var2To - var2From) + var2From))/var2Magnitude;
	}
else 
	{
	var2Number = Math.round(random2*(var2To - var2From) + var2From);
	}
var2NumberToString = var2Number.toString();



question = question.replace(var1ReplaceString, var1NumberToString);
question = question.replace(var2ReplaceString, var2NumberToString);
//The question is now ready to be asked to the student.
document.getElementById('generatedQuestion').innerHTML = question;
MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
document.getElementById('userAnswer').style.visibility="visible";
document.getElementById('checkAnswer').style.visibility="visible";

answer = document.getElementById('answer').value
answ = Parser.evaluate( answer, { var1: var1Number, var2: var2Number});
generatedAnswer.ansh = parseFloat(answ);
}

function answerProblem() {
userAnswer = document.getElementById('userAnswer').value;
feedback = "Enter an answer.";
feedbackCorrect = "You sun of a gun. You got it right!";
feedbackIncorrect = "Sorry boy. Try again.";
answernumber = generatedAnswer.ansh;
if (Math.abs(parseFloat(userAnswer) - answernumber) < 0.1)
	{
	feedback = feedbackCorrect;
	}
else
	{
	feedback = feedbackIncorrect;
	}
document.getElementById('feedback').innerHTML = feedback;
}
</script>

</body>